var __awaiter=this&&this.__awaiter||function(a,c,e,b){function d(g){return g instanceof e?g:new e(function(h){h(g)})}return new (e||=Promise)(function(g,h){function m(f){try{k(b.next(f))}catch(l){h(l)}}function n(f){try{k(b["throw"](f))}catch(l){h(l)}}function k(f){f.done?g(f.value):d(f.value).then(m,n)}k((b=b.apply(a,c||[])).next())})};const thisScriptElement=document.getElementById("cituro-ratings-script");
class CannotFetchDataError extends Error{constructor(a){super(a.message);this.errorObj=a}get errorObject(){return this.errorObj}}
function fetchCituroData(){return __awaiter(this,void 0,void 0,function*(){if(thisScriptElement){var a=thisScriptElement.getAttribute("data-user-account");const c=thisScriptElement.getAttribute("data-limit"),e=thisScriptElement.getAttribute("data-surrounding-element-id");if(a&&e){const b=document.getElementById(e);if(b){a=`https://app.cituro.com/api/ratings/${a}?limit=${c}&sort=-createdAt`;console.log(`calling ${a}`);a=yield fetch(a);if(!a.ok)throw console.log(b),new CannotFetchDataError({message:a.statusText,
surroundingElement:b});({data:a}=yield a.json());a.forEach(d=>{console.log(d);createRatingElements(b,d)})}}else throw new CannotFetchDataError({message:"Could not extract data-user-account or data-surrounding-element-id from script. Please provide them!",surroundingElement:null});}else throw new CannotFetchDataError({message:"Please give this script an id of 'cituro-ratings-script'!",surroundingElement:null});})}
function createRatingElements(a,c){const e=document.createElement("div");e.classList.add("rating-content");var b=document.createElement("div");b.classList.add("rating-header");e.appendChild(b);var d=document.createElement("span");d.classList.add("customer-name");d.textContent=c.anonymous?"Anonym":c.customerName;b.appendChild(d);d=document.createElement("span");d.classList.add("rating-stars");d.append(...generateRatingStarsSvg(c.rating));b.appendChild(d);d=document.createElement("span");d.classList.add("rating-date");
d.textContent=`vom ${(new Date(c.createdAt)).toLocaleDateString("de-DE")}`;b.appendChild(d);b=document.createElement("div");b.classList.add("rating-comment");b.textContent=c.comment;e.appendChild(b);a.appendChild(e)}
function generateRatingStarsSvg(a){const c=[];for(let e=0;e<a;e++){const b=document.createElementNS("http://www.w3.org/2000/svg","svg");b.setAttribute("fill","currentColor");b.setAttribute("stroke","currentColor");b.setAttribute("stroke-width","1.5");b.setAttribute("viewBox","0 0 24 24");b.setAttribute("aria-hidden","true");const d=document.createElementNS("http://www.w3.org/2000/svg","path");d.setAttribute("stroke-linecap","round");d.setAttribute("stroke-linejoin","round");d.setAttribute("d","M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.563.563 0 00-.586 0L6.982 20.54a.562.562 0 01-.84-.61l1.285-5.386a.562.562 0 00-.182-.557l-4.204-3.602a.563.563 0 01.321-.988l5.518-.442a.563.563 0 00.475-.345L11.48 3.5z");
b.appendChild(d);c.push(b)}return c}
function generateSadSmileySvg(){const a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttribute("fill","none");a.setAttribute("stroke","currentColor");a.setAttribute("stroke-width","1.5");a.setAttribute("viewBox","0 0 24 24");a.setAttribute("aria-hidden","true");const c=document.createElementNS("http://www.w3.org/2000/svg","path");c.setAttribute("stroke-linecap","round");c.setAttribute("stroke-linejoin","round");c.setAttribute("d","M15.182 16.318A4.486 4.486 0 0012.016 15a4.486 4.486 0 00-3.198 1.318M21 12a9 9 0 11-18 0 9 9 0 0118 0zM9.75 9.75c0 .414-.168.75-.375.75S9 10.164 9 9.75 9.168 9 9.375 9s.375.336.375.75zm-.375 0h.008v.015h-.008V9.75zm5.625 0c0 .414-.168.75-.375.75s-.375-.336-.375-.75.168-.75.375-.75.375.336.375.75zm-.375 0h.008v.015h-.008V9.75z");a.appendChild(c);
a.id="sad-smiley";return a}fetchCituroData().catch(a=>{if((a=a.errorObject)&&a.surroundingElement){const c=document.createElement("div");c.classList.add("rating-error");const e=document.createElement("p");e.classList.add("rating-error-text");e.textContent="Fehler beim Laden der Bewertungen!";c.appendChild(e);c.appendChild(generateSadSmileySvg());a.surroundingElement.appendChild(c)}});
